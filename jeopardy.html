<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Chem Jeopardy Review</title>
<style>
  :root{
    --bg:#f4f6fb; --text:#1f2a44; --muted:#5a6b8a; --card:#fff; --line:#e3e7f2;
    --u1:#3498db; --u2:#27ae60; --u3:#9b59b6; --u4:#e74c3c; --u5:#f39c12; --u6:#16a085;
    --shadow: 0 10px 25px rgba(16,24,40,.12);
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;background:var(--bg);color:var(--text);}
  header{max-width:1200px;margin:18px auto 10px; padding:0 16px; display:flex; gap:12px; align-items:center; flex-wrap:wrap;}
  header h1{margin:0;font-size:20px}
  .pill{padding:6px 10px;border:1px solid var(--line);border-radius:999px;background:#fff;color:var(--muted);font-size:12px}
  .controls{margin-left:auto;display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  .btn{border:1px solid var(--line);background:#fff;color:var(--text);padding:8px 10px;border-radius:10px;cursor:pointer}
  .btn:hover{border-color:#b9c6ff}
  main{max-width:1200px;margin:0 auto;padding:12px 16px 28px;}
  .topGrid{display:grid;grid-template-columns:1fr;gap:12px;margin-bottom:12px;}
  @media (min-width:980px){ .topGrid{grid-template-columns: 1fr 440px;} }

  /* Team panel */
  .teamPanel{background:#fff;border:1px solid var(--line);border-radius:16px;box-shadow:0 2px 10px rgba(16,24,40,.06);padding:14px;}
  .teamPanel h2{margin:0 0 10px 0;font-size:14px;color:var(--muted);letter-spacing:.2px}
  .teamRow{display:grid;grid-template-columns:1fr auto;gap:10px;align-items:center;border:1px solid var(--line);border-radius:14px;padding:10px;margin:10px 0;background:#fff;}
  .teamTop{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  .teamNameInput{width:190px; max-width:100%; padding:7px 9px; border:1px solid var(--line); border-radius:10px;}
  .teamScore{font-weight:950;font-size:18px; min-width:64px; text-align:right;}
  .teamBtns{display:flex;gap:8px;align-items:center;flex-wrap:wrap;justify-content:flex-end}
  .small{font-size:12px;color:var(--muted);margin-top:10px;line-height:1.35}
  .row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  .danger{border-color:#ffd6d6}
  .danger:hover{border-color:#ff6b6b}

  /* Board */
  .board{display:grid;grid-template-columns:repeat(6,1fr);gap:10px;}
  .cat{color:#fff;border-radius:14px;padding:12px;box-shadow:var(--shadow);font-weight:900;text-align:center;min-height:64px;display:flex;align-items:center;justify-content:center;}
  .cell{
    background:#fff;border:1px solid var(--line);border-radius:14px;box-shadow:0 2px 10px rgba(16,24,40,.06);
    padding:18px; text-align:center; font-weight:900; font-size:20px; cursor:pointer;
    display:flex; align-items:center; justify-content:center; min-height:74px;
  }
  .cell.used{opacity:.35; cursor:not-allowed; text-decoration:line-through}
  .cell.dd{border:2px solid #ffd166}
  .cell:hover{border-color:#b9c6ff}
  .hint{color:var(--muted);font-size:12px;margin-top:10px}

  /* Modal */
  .overlay{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;align-items:center;justify-content:center;padding:16px;}
  .modal{width:min(900px,100%); background:#fff; border-radius:18px; border:1px solid var(--line); box-shadow:var(--shadow); overflow:hidden;}
  .mhead{padding:14px 16px; color:#fff; display:flex; gap:10px; align-items:center; justify-content:space-between;}
  .mhead .left{display:flex; gap:10px; align-items:center; flex-wrap:wrap;}
  .tag{font-weight:900}
  .value{background:rgba(255,255,255,.18); border:1px solid rgba(255,255,255,.22); padding:4px 8px; border-radius:999px; font-weight:900}
  .close{background:rgba(255,255,255,.18); border:1px solid rgba(255,255,255,.22); color:#fff; padding:6px 10px; border-radius:10px; cursor:pointer}
  .close:hover{background:rgba(255,255,255,.26)}
  .mbody{padding:16px;}

  /* Bigger clue text */
  .qtext{font-size:32px; font-weight:950; line-height:1.2;}
  .sub{margin-top:10px; color:var(--muted); font-size:14px}
  .reveal{display:none; margin-top:16px; padding:14px; border-left:4px solid #b9c6ff; background:#f3f6ff; border-radius:12px;}
  .reveal b{display:block;margin-bottom:8px;font-size:14px}
  .reveal .ans{font-size:22px;font-weight:900;line-height:1.25}
  select{border:1px solid var(--line); border-radius:10px; padding:8px 10px; background:#fff;}
</style>
</head>
<body>

<header>
  <h1>Chem Jeopardy Review</h1>
  <span class="pill">Big clue text + team scoring</span>
  <div class="controls">
    <button class="btn" id="reset">Reset board & scores</button>
    <button class="btn" id="random">Random clue</button>
  </div>
</header>

<main>
  <div class="topGrid">
    <div>
      <div class="board" id="board"></div>
      <div class="hint">Tip: Award points in the clue popup. “Mark used” works if no one gets it.</div>
    </div>

    <aside class="teamPanel">
      <h2>Teams</h2>

      <div class="row">
        <button class="btn" id="addTeam">+ Add team</button>
      </div>

      <div id="teams"></div>

      <div class="small">
        Team names + scores save in this browser (localStorage).<br>
        Rename a team by editing its name box.
      </div>
    </aside>
  </div>
</main>

<div class="overlay" id="overlay" role="dialog" aria-modal="true">
  <div class="modal">
    <div class="mhead" id="mhead">
      <div class="left">
        <span class="tag" id="mtag">Category</span>
        <span class="value" id="mval">$100</span>
        <span class="value" id="mdd" style="display:none;">DAILY DOUBLE</span>
      </div>
      <button class="close" id="close">Close</button>
    </div>
    <div class="mbody">
      <div class="qtext" id="qtext"></div>
      <div class="sub" id="qsub"></div>

      <div class="row" style="margin-top:14px;">
        <button class="btn" id="showAns">Reveal answer</button>
        <span class="sub" style="margin:0;">Award points:</span>
        <select id="teamSelect"></select>
        <button class="btn" id="awardPlus">+ value</button>
        <button class="btn" id="awardMinus">− value</button>
        <button class="btn" id="markUsed">Mark used</button>
      </div>

      <div class="reveal" id="reveal">
        <b>Answer</b>
        <div class="ans" id="atext"></div>
      </div>
    </div>
  </div>
</div>

<script>
/* =========================
   DATA (6 categories x 5 values)
========================= */
const CATS = [
  { id:"intro",  name:"Intro to Chem",  color:"var(--u1)" },
  { id:"atoms",  name:"Atoms",          color:"var(--u2)" },
  { id:"ptable", name:"Periodic Table", color:"var(--u3)" },
  { id:"bond",   name:"Bonding",        color:"var(--u4)" },
  { id:"moles",  name:"Moles",          color:"var(--u5)" },
  { id:"eq",     name:"Equations",      color:"var(--u6)" },
];
const VALUES = [100,200,300,400,500];

const CLUES = {
  intro: [
    {q:"Name the property type: depends on the amount of substance (mass, volume).", a:"Extensive property."},
    {q:"Accuracy vs precision: which means “close to the true value”?", a:"Accuracy."},
    {q:"Classify matter: element, compound, or mixture? (salt water)", a:"Mixture (homogeneous solution)."},
    {q:"Physical vs chemical change: rusting iron is which kind?", a:"Chemical change (new substance forms)."},
    {q:"Significant figures: How many sig figs in 0.04050?", a:"4 significant figures."}
  ],
  atoms: [
    {q:"If wavelength decreases, what happens to frequency (and energy)?", a:"Frequency increases (and energy increases)."},
    {q:"What did Rutherford’s gold foil experiment reveal about atoms?", a:"A small, dense, positively charged nucleus; atoms are mostly empty space."},
    {q:"Same element, different neutrons: what are these called?", a:"Isotopes."},
    {q:"An atom with 17 protons and 18 electrons has what net charge?", a:"-1 (one extra electron)."},
    {q:"Average atomic mass is calculated as what kind of average?", a:"A weighted average using isotopic abundances."}
  ],
  ptable: [
    {q:"Across a period (left to right), atomic radius generally does what?", a:"Decreases."},
    {q:"Down a group, ionization energy generally does what?", a:"Decreases."},
    {q:"Elements in the same group share similar chemistry because they share similar…", a:"Valence electron patterns."},
    {q:"Name the families: Group 1 and Group 17 are called what?", a:"Alkali metals; Halogens."},
    {q:"Which trend increases toward the top-right corner of the table (toward F)?", a:"Electronegativity (and ionization energy generally increases up/right)."}
  ],
  bond: [
    {q:"Bond type most likely between a metal and a nonmetal?", a:"Ionic bonding."},
    {q:"VSEPR: AX2E2 has what molecular shape?", a:"Bent (tetrahedral electron geometry)."},
    {q:"Which is polar: CO2, CH4, or NH3?", a:"NH3 is polar."},
    {q:"Name the IMF: attraction between partial charges in polar molecules.", a:"Dipole-dipole forces."},
    {q:"Why do ionic compounds conduct electricity in solution but not as solids?", a:"Ions are mobile in solution; locked in place in a solid lattice."}
  ],
  moles: [
    {q:"How many particles are in 1 mole?", a:"6.022 x 10^23 particles (Avogadro’s number)."},
    {q:"Convert: 22.0 g NaCl (58.44 g/mol) to moles (closest).", a:"Approximately 0.376 mol."},
    {q:"Define percent composition.", a:"(mass of element ÷ total mass of compound) x 100%."},
    {q:"Empirical vs molecular formula: which is simplest whole-number ratio?", a:"Empirical formula."},
    {q:"Empirical CH2, molar mass 56 g/mol: molecular formula?", a:"C4H8 (because 56/14 = 4)."}
  ],
  eq: [
    {q:"Balance: __Al + __O2 -> __Al2O3", a:"4Al + 3O2 -> 2Al2O3."},
    {q:"Classify: CH4 + 2O2 -> CO2 + 2H2O", a:"Combustion."},
    {q:"Reaction pattern: AB -> A + B is called what?", a:"Decomposition."},
    {q:"Reaction pattern: A + BC -> AC + B is called what?", a:"Single replacement (single displacement)."},
    {q:"Why do we balance equations?", a:"To obey conservation of atoms/mass (same number of each atom on both sides)."}
  ]
};

/* =========================
   STATE
========================= */
const KEY = "chemJeopTeamsV2";
let state = JSON.parse(localStorage.getItem(KEY) || "{}");
if (!state.used) state.used = {};               // used["cat-idx"]=true
if (!state.teams) state.teams = ["Team A","Team B","Team C"]; // editable list
if (!state.teamScores) state.teamScores = {};  // {teamName:number}
if (!state.dd) state.dd = null;

function save(){
  localStorage.setItem(KEY, JSON.stringify(state));
}
function cellKey(catId, idx){ return `${catId}-${idx}`; }

function pickDailyDouble(){
  const all = [];
  for (const cat of CATS) for (let i=0;i<5;i++) all.push({catId:cat.id, idx:i});
  const unused = all.filter(x => !state.used[cellKey(x.catId, x.idx)]);
  if (unused.length === 0) return null;
  return unused[Math.floor(Math.random()*unused.length)];
}

/* =========================
   TEAMS UI
========================= */
const teamsHost = document.getElementById("teams");
const teamSelect = document.getElementById("teamSelect");
document.getElementById("addTeam").addEventListener("click", ()=>{
  const nextNum = state.teams.length + 1;
  const name = `Team ${nextNum}`;
  state.teams.push(name);
  if (typeof state.teamScores[name] !== "number") state.teamScores[name] = 0;
  save();
  renderTeams();
});

function renameTeam(oldName, newName){
  newName = (newName || "").trim();
  if (!newName || newName === oldName) return;

  // prevent duplicates
  if (state.teams.includes(newName)){
    alert("That team name already exists.");
    return;
  }

  // move score
  const oldScore = state.teamScores[oldName] || 0;
  delete state.teamScores[oldName];
  state.teamScores[newName] = oldScore;

  // swap in teams array
  state.teams = state.teams.map(t => t===oldName ? newName : t);

  save();
  renderTeams();
}

function deleteTeam(name){
  if (state.teams.length <= 1){
    alert("Keep at least one team.");
    return;
  }
  if (!confirm(`Delete ${name}?`)) return;

  // remove
  state.teams = state.teams.filter(t => t !== name);
  delete state.teamScores[name];

  save();
  renderTeams();
}

function renderTeams(){
  // ensure all scores exist
  for (const t of state.teams){
    if (typeof state.teamScores[t] !== "number") state.teamScores[t] = 0;
  }

  teamSelect.innerHTML = "";
  state.teams.forEach(t=>{
    const opt = document.createElement("option");
    opt.value = t;
    opt.textContent = t;
    teamSelect.appendChild(opt);
  });

  teamsHost.innerHTML = "";
  state.teams.forEach((name)=>{
    const row = document.createElement("div");
    row.className = "teamRow";

    const left = document.createElement("div");
    left.className = "teamTop";

    const input = document.createElement("input");
    input.className = "teamNameInput";
    input.value = name;
    input.setAttribute("aria-label", "Team name");
    input.addEventListener("keydown", (e)=>{
      if (e.key === "Enter"){
        e.preventDefault();
        input.blur();
      }
    });
    input.addEventListener("blur", ()=>{
      renameTeam(name, input.value);
    });

    const score = document.createElement("div");
    score.className = "teamScore";
    score.textContent = state.teamScores[name];

    left.appendChild(input);
    left.appendChild(score);

    const right = document.createElement("div");
    right.className = "teamBtns";

    const plus = document.createElement("button"); plus.className="btn"; plus.textContent="+100";
    const minus = document.createElement("button"); minus.className="btn"; minus.textContent="-100";
    const reset = document.createElement("button"); reset.className="btn"; reset.textContent="Reset";
    const del = document.createElement("button"); del.className="btn danger"; del.textContent="Delete";

    plus.addEventListener("click", ()=>{ state.teamScores[name]+=100; save(); renderTeams(); });
    minus.addEventListener("click", ()=>{ state.teamScores[name]-=100; save(); renderTeams(); });
    reset.addEventListener("click", ()=>{ state.teamScores[name]=0; save(); renderTeams(); });
    del.addEventListener("click", ()=> deleteTeam(name));

    right.appendChild(plus); right.appendChild(minus); right.appendChild(reset); right.appendChild(del);

    row.appendChild(left);
    row.appendChild(right);
    teamsHost.appendChild(row);
  });

  save();
}

/* =========================
   BOARD
========================= */
const board = document.getElementById("board");
function renderBoard(){
  board.innerHTML = "";

  for (const cat of CATS){
    const el = document.createElement("div");
    el.className = "cat";
    el.style.background = cat.color;
    el.textContent = cat.name;
    board.appendChild(el);
  }

  if (!state.dd) state.dd = pickDailyDouble();
  const dd = state.dd;

  for (let r=0;r<5;r++){
    for (const cat of CATS){
      const idx = r;
      const value = VALUES[r];
      const k = cellKey(cat.id, idx);

      const el = document.createElement("div");
      el.className = "cell";
      el.textContent = "$" + value;

      if (state.used[k]) el.classList.add("used");
      if (dd && dd.catId === cat.id && dd.idx === idx && !state.used[k]) el.classList.add("dd");

      el.addEventListener("click", ()=>{
        if (state.used[k]) return;
        const isDD = dd && dd.catId===cat.id && dd.idx===idx;
        openClue(cat.id, idx, value, isDD);
      });

      board.appendChild(el);
    }
  }
  save();
}

/* =========================
   MODAL / AWARDING
========================= */
const overlay = document.getElementById("overlay");
const closeBtn = document.getElementById("close");
const mhead = document.getElementById("mhead");
const mtag = document.getElementById("mtag");
const mval = document.getElementById("mval");
const mdd = document.getElementById("mdd");
const qtext = document.getElementById("qtext");
const qsub = document.getElementById("qsub");
const reveal = document.getElementById("reveal");
const atext = document.getElementById("atext");

let currentClue = null;

function openClue(catId, idx, value, isDD){
  const cat = CATS.find(c=>c.id===catId);
  const clue = CLUES[catId][idx];
  currentClue = {catId, idx, value, dd:isDD};

  mhead.style.background = cat.color;
  mtag.textContent = cat.name;
  mval.textContent = "$" + value;
  mdd.style.display = isDD ? "inline-block" : "none";

  qtext.textContent = clue.q;
  qsub.textContent = isDD ? "Daily Double: use listed value (or verbally set a wager)." : "Give teams ~20–30 seconds, then reveal.";

  reveal.style.display = "none";
  atext.textContent = clue.a;

  overlay.style.display = "flex";
}
function closeClue(){
  overlay.style.display = "none";
  currentClue = null;
}
closeBtn.addEventListener("click", closeClue);
overlay.addEventListener("click", (e)=>{ if(e.target===overlay) closeClue(); });

document.getElementById("showAns").addEventListener("click", ()=>{
  reveal.style.display = (reveal.style.display==="block") ? "none" : "block";
});

function markUsed(){
  if (!currentClue) return;
  state.used[cellKey(currentClue.catId, currentClue.idx)] = true;
  if (state.dd && state.dd.catId===currentClue.catId && state.dd.idx===currentClue.idx){
    state.dd = pickDailyDouble();
  }
  save();
  renderBoard();
}

function award(delta){
  if (!currentClue) return;
  const team = teamSelect.value;
  state.teamScores[team] = (state.teamScores[team] || 0) + delta;
  markUsed();
  renderTeams();
}

document.getElementById("awardPlus").addEventListener("click", ()=> award(+currentClue.value));
document.getElementById("awardMinus").addEventListener("click", ()=> award(-currentClue.value));
document.getElementById("markUsed").addEventListener("click", markUsed);

/* =========================
   CONTROLS
========================= */
document.getElementById("reset").addEventListener("click", ()=>{
  if (!confirm("Reset the board AND all team scores?")) return;
  state.used = {};
  state.dd = null;
  for (const t of state.teams) state.teamScores[t] = 0;
  save();
  renderTeams();
  renderBoard();
  closeClue();
});

document.getElementById("random").addEventListener("click", ()=>{
  const unused = [];
  for (const cat of CATS){
    for (let i=0;i<5;i++){
      const k = cellKey(cat.id,i);
      if (!state.used[k]) unused.push({catId:cat.id, idx:i});
    }
  }
  if (unused.length===0){ alert("All clues used!"); return; }
  const pick = unused[Math.floor(Math.random()*unused.length)];
  const value = VALUES[pick.idx];
  const isDD = state.dd && state.dd.catId===pick.catId && state.dd.idx===pick.idx;
  openClue(pick.catId, pick.idx, value, isDD);
});

/* init */
renderTeams();
renderBoard();
</script>
</body>
</html>
